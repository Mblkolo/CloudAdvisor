<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>МетеоСочи</title>

    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link href="carousel.css" rel="stylesheet">
    <style id="holderjs-style" type="text/css"></style>
</head>


<body style="">
<div class="navbar-wrapper">
    <div class="container">

        <div class="navbar navbar-inverse navbar-static-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#" id="Start">МетеоСочи</a>
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li class="active" id="Latest"><a href="#">Последний снимок</a></li>
                        <li class="dropdown" id="DateList">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Даты <b class="caret"></b></a>
                            <ul class="dropdown-menu" id="placeholder">
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </div>
</div>

<div id="myCarousel" class="carousel">
    <ol class="carousel-indicators" id="Indicators"></ol>

    <div class="carousel-inner" id="ImageRegion"></div>

    <a class="left carousel-control" href="#myCarousel" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a>
    <a class="right carousel-control" href="#myCarousel" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
</div>

<div class="container marketing">
    <footer>

    </footer>
</div>

<script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
<script src="docs.min.js"></script>

<script>
    var testLink = ""

    function Start(data){
        var output = "";
        var outputIndicators = "";

        if (data.image == ""){
            output += UpdateImage(data.url, "empty.png", true);
        }
        else{
            output += UpdateImage(data.url, data.image, true);
        }

        outputIndicators += "<li data-target=\"#myCarousel\" data-slide-to=\"0\" class=\"Active\"></li>"

        document.getElementById("ImageRegion").innerHTML=output;
        document.getElementById("Indicators").innerHTML=outputIndicators;
    }

    function UpdateImage(suffix, imageName, isActive){

        var output = "";

        output += "<div class=\"item"

        if (isActive)

            output +=" active";


        output += "\"> <div class=\"container\"><div class=\"carousel-caption\">";
        output += "<img src=\""+ testLink + suffix + "/" + imageName +"\" width=\"1136\" height=\"640\" class=\"center-block img-responsive\" >";

        output += "<p> Снимок за " + imageName.split('.')[0] + " </p>"

        output += "</div></div></div>"



        return output;

    }

    function FillDates(data){
        var output = "";

        for(var i in data.dates){
            output += "<li><a href=\"#\">" + data.dates[i] + "</a></li>";
        }

        document.getElementById("placeholder").innerHTML=output;
    }

    function ImageListUpdate(data){
        var outputItems = "";
        var outputIndicators = "";

        for(var i in data.images){
            if (i == 0){
                outputItems += UpdateImage(data.url, data.images[i], true);
                outputIndicators += "<li data-target=\"#myCarousel\" data-slide-to=\"" + i + "\" class=\"active\"></li>";
            }
            else{
                outputItems += UpdateImage(data.url, data.images[i], false);
                outputIndicators += "<li data-target=\"#myCarousel\" data-slide-to=\"" + i + "\" class=\"\"></li>";
            }
        }

        document.getElementById("ImageRegion").innerHTML=outputItems;
        document.getElementById("Indicators").innerHTML=outputIndicators;
    }

    function GetData (url, callback) {
        $.getJSON(url, function(data){
            callback(data);
        });
    }

    GetData(testLink + "/date/all/", FillDates);
    GetData(testLink + "/latest/", Start);

    $(document).ready(function(){
        $('#DateList ul').click(function(e){
            date = e.target.text;

            $('#DateList').addClass("active");
            $('#Latest').removeClass("active");

            GetData(testLink + "/date/" + date + "/" , ImageListUpdate);
        });

        $('#Latest').click(function(){

            $('#DateList').removeClass("active");
            $('#Latest').addClass("active");

            GetData(testLink+ "/latest/", Start);
        });

        $('#Start').click(function(){

            $('#DateList').removeClass("active");
            $('#Latest').addClass("active");

            GetData(testLink+ "/latest/", Start);
        });
    });
</script>

<script type="text/javascript">
    var googleAnalyticsKey = "UA-47817014-1";

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', googleAnalyticsKey]);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>

</body>
</html>
